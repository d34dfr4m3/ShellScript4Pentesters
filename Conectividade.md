## Conectividade
Nesse paper será abordado os seguintes tópicos:
- Definição básica de rede
	- IP
	- TCP/UDP
	- Serviços 
	- ICMP
- Comunicação de Rede.
- DNS

### Definição Básica de Rede. 
Bom, estamos todos conectados à Internet. Na Internet todo mundo tem que ter um endereço para que possa acessar e ser acessado outros Hosts na Internet.

#### O que é um IP?
IP é um protocolo que está para Internet Protocol, ele basicamente é um protocolo de endereçamento e opera na camada de rede. Vamos focar apenas no IPv4, possui 32 bits:
![IPv4](https://core0.staticworld.net/images/article/2015/11/ipv4-100629207-orig.png)

O que nós chamamos de octeto é a composição de 8 bits por bloco sendo no total 4 blocos resultando em 32 bits. Conforme a imagem acima pode-se notar que é convertido de decimal para binário. Não entraremos nos detalhes sobre conversão e máscaras de rede etc, o foco não é esse. O que importa é que todos temos um endereço IPv4 público. 

Para você identificar o seu endereço na Internet você pode abrir um site qualquer que informe seu endereço IPv4 mas como estamos lidando com um paper sobre shellscript vamos fazer isso usando o comando curl: 

```
curl meuip.com | egrep "[0-9]+\.[0-9]+\.[0-9]+\.[0-9]"
```
O comando acima utiliza o **curl** e o **egrep** com um pouco de expressão regular. O **curl** irá fazer uma requição web para **meuip.com** e atráves do pipe irá encaminhar para a entrada do comando **egrep** que irá aplicar a expressão regular e trazer todas as ocorrencias do que seria um endereço IPv4. 

Esse é o seu endereço IPv4 na Internet. 
#### Protocolos de Transporte. 
Mais além disso nós temos dois protocolos principais de transporte, o **TCP** e o **UDP**, eles operam de forma diferente e são os responsáveis por ir até o nosso destino. 

- TCP: Opera com estabelecimento de conexão atráces do 3way handshake, trata perda de pacotes e etc.
- UDP: Simplesmente envia, sem estabelecer a conexão antes e tão pouco se importa se o pacote chegou ao destino. 

#### Serviços
Então a partir disso tudo, nós seres humanos acessamos serviços na Internet, por exemplo, um website. Websites geralmente operam em duas portas **80** e **443**, sendo a primeira que não implementa criptografia e a segunda que implementa criptografia usando SSL/TLS. 

Então com isso em mente nós podemos simplesmente nos conectar a esses serviços usando o endereço IP e a Porta. 

Vamos realizar um teste utilizando o netcat. O Netcat é o canivete suiço dos hackers pois permite conexão em portas usando tanto TCP como UDP e outras coisas interessantes. 

A sintaxe do netcat é bem simples:
```
nc <IP> <port> 
```

Então vamos nos conectar ao servidor **meuip.com**:

```
$ echo 'GET / HTTP/1.1/r/n' | nc meuip.com 80
HTTP/1.1 400 Bad Request
Date: Sat, 17 Nov 2018 21:57:20 GMT
Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/5.6.38
Content-Length: 226
Connection: close
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>400 Bad Request</title>
</head><body>
<h1>Bad Request</h1>
<p>Your browser sent a request that this server could not understand.<br />
</p>
</body></html>

```
Então é possível lidar com esses serviços diretamente atráves da linha de comando. Existem vários outros serviços, cada porta é um serviço de rede, segue abaixo uma tabela: 
![network ports](https://patentimages.storage.googleapis.com/WO2002061510A2/imgf000036_0001.png)

Você também poderia consultar o arquivo **/etc/services** das duas seguintes formas:
```
$ grep '80/tcp' /etc/services 
http		80/tcp		www		# WorldWideWeb HTTP
socks		1080/tcp			# socks proxy server
http-alt	8080/tcp	webcache	# WWW caching service
amanda		10080/tcp			# amanda backup services
canna		5680/tcp			# cannaserver
``` 
Observe que ele exibe a porta 80/tcp como sendo um serviço HTTP. 

A outra forma seria atráves do **getent** que realiza a busca nessa base: 
```
$ getent services 80
http                  80/tcp www

```

Com isso nós sabemos que a porta 80/TCP geralmente é para serviços de HTTP, isso é um padrão porem não mandatório, o responsável pelo servidor poderia simplesmente colocar qualquer outro serviço na porta 80/tcp porém como falei, se ele colocasse o website na porta 8888, por padrão todo mundo iria tentar acessar a 80/tcp, logo é mais fácil colocar o serviço na porta padrão do que colocar numa outra porta.

#### ICMP
O ICMP é o tal do ping, é um protocolo que opera na camada 3, é um subprotocolo do protocolo IP porém com ele é possível realizar pings em portas, o que nós podemos chamar de protocolo de camada 2.5(dois e meio?, acho que fica bom)

Esse protocolo faz nada mais nada menos que verificar se um host está na rede, vocẽ dispara o ping e se o servidor responder significa que ele está ONLINE, caso ele não responda ele pode estar offline ou ter algum firewall bloqueando o protocolo ICMP. 

Observe:
``` 
$ ping -c 5 192.168.1.2
PING 192.168.1.2 (192.168.1.2) 56(84) bytes of data.
64 bytes from 192.168.1.2: icmp_seq=1 ttl=64 time=1.45 ms
64 bytes from 192.168.1.2: icmp_seq=2 ttl=64 time=1.10 ms
64 bytes from 192.168.1.2: icmp_seq=3 ttl=64 time=1.69 ms
64 bytes from 192.168.1.2: icmp_seq=4 ttl=64 time=1.09 ms
64 bytes from 192.168.1.2: icmp_seq=5 ttl=64 time=1.21 ms

--- 192.168.1.2 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4005ms
rtt min/avg/max/mdev = 1.093/1.313/1.696/0.231 ms
```

Foi disparado 5 pacotes para o ip **192.168.1.2** e ele respondeu todos os 5, significa que o host está ativo.

Agora outros programas que utilizam o icmp são:
- mtr
- traceroute/tracepath

Os dois programas tem a ideia de medir a rota até um determinado destino, então eles mapeiam todos os hop's até determinado destino, observe abaixo um exemplo de uso do comando mtr: 
```
$ mtr -n meuip.com -c 10 -r 
Start: 2018-11-17T20:06:43-0200
HOST: remember                    Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- 192.168.1.2                0.0%    10   43.1   8.8   1.1  43.1  14.3
   [ REMOVIDO ]
 21.|-- 54.233.138.36              0.0%    10  360.1 214.3  74.9 419.5 113.6

```

Então nosso pacote passa por aproximadamente 20 hop's antes de alcançar nosso destino. 

Teste o comando traceroute e veja como ele funciona. 

### Comunicação de Rede.
Nesse tópico iremos abordar os seguintes programas:
- Netcat
- Telnet
- Wget
- Curl

#### Netcat
Bom, conforme citado no tópico anterior, o **netcat** é uma ferramenta muito útil pois permite que nós seres humanos conectarmos em hosts pela Internet e até ser conectados. 


### DNS
Nesse tópico iremos abordar os seguintes tópicos:
- O que é DNS 
- Dig
- Host

